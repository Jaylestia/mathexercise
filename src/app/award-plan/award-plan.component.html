<md-card>
  <md-card-header>
    <md-card-title>{{pageHeader | translate}}</md-card-title>
  </md-card-header>
  <md-card-content>
    <md-toolbar color="primary">
      <md-select placeholder="{{'Home.User' | translate}}" [disabled]="!IsListView" 
        [(ngModel)]="SelectedUser" name="usr" (change)="onUserChanged($event)">
        <md-option *ngFor="let user of listUsers" [value]="user">
          {{ user.displayas }}
        </md-option>
      </md-select>

      <button md-icon-button [disabled]="!IsListView || (SelectedUser === null) || (CurrentUser === null) || (CurrentUser !== null && !CurrentUser.AwardPlanCreate)" (click)="onCreatePlan()">
        <md-icon class="md-24" aria-label="Create">create_new_folder</md-icon>
      </button>

      <!-- This fills the remaining space of the current row -->
      <span class="example-fill-remaining-space"></span>
      <span>{{'Home.AwardPlanByUser' | translate}}</span>
    </md-toolbar>

    <div class="example-container mat-elevation-z8">
      <md-table #table [dataSource]="dataSource">

        <ng-container mdColumnDef="ID">
          <md-header-cell *mdHeaderCellDef> # </md-header-cell>
          <md-cell *mdCellDef="let element">
            <button md-mini-fab [disabled]="!IsListView || (CurrentUser === null) || (CurrentUser !== null && !CurrentUser.AwardPlanUpdate)" 
              (click)="onEditPlan(element)">
              <md-icon class="md-14" aria-label="Edit">edit</md-icon>
            </button>
            <button md-mini-fab [disabled]="!IsListView || (CurrentUser === null) || (CurrentUser !== null && !CurrentUser.AwardPlanDelete)" 
              (click)="onDeletePlan(element)">
              <md-icon class="md-14" aria-label="Delete">delete</md-icon>
            </button>
            {{element.ID}} 
          </md-cell>
        </ng-container>
        <ng-container mdColumnDef="ValidFrom">
          <md-header-cell *mdHeaderCellDef> {{'Home.ValidFrom' | translate }} </md-header-cell>
          <md-cell *mdCellDef="let element"> {{element.ValidFromFormatString}} </md-cell>
        </ng-container>
        <ng-container mdColumnDef="ValidTo">
          <md-header-cell *mdHeaderCellDef> {{'Home.ValidTo' | translate }} </md-header-cell>
          <md-cell *mdCellDef="let element"> {{element.ValidToFormatString}} </md-cell>
        </ng-container>
        <ng-container mdColumnDef="QuizType">
          <md-header-cell *mdHeaderCellDef> {{'Home.QuizType' | translate }} </md-header-cell>
          <md-cell *mdCellDef="let element"> {{element.getQuizTypeUIString() | translate}} </md-cell>
        </ng-container>
        <ng-container mdColumnDef="AwardCondition">
          <md-header-cell *mdHeaderCellDef> {{'Home.AwardCondition' | translate }} </md-header-cell>
          <md-cell *mdCellDef="let element"> 
            <span>{{element.getAwardScoreCondition() | translate: element.getAwardScoreConditionParam()}} ;</span> 
            <span>{{element.getAwardAvgTimeCondition() | translate: element.getAwardAvgTimeConditionParam()}}</span> </md-cell>
        </ng-container>
        <ng-container mdColumnDef="Award">
          <md-header-cell *mdHeaderCellDef> {{'Home.Award' | translate }} </md-header-cell>
          <md-cell *mdCellDef="let element"> {{element.Award}} </md-cell>
        </ng-container>

        <md-header-row *mdHeaderRowDef="displayedColumns"></md-header-row>
        <md-row *mdRowDef="let row; columns: displayedColumns;"></md-row>
      </md-table>

      <md-paginator #paginator [length]="_apService.AwardPlans.length" [pageIndex]="0" [pageSize]="25" [pageSizeOptions]="[5, 10, 25, 100]">
      </md-paginator>      
    </div>

    <div *ngIf="!IsListView">
      <div class="demo-full-width">
        <md-form-field>
          <input mdInput type="text" placeholder="{{'Home.User' | translate}}" readonly [(ngModel)]="SelectedUser.displayas">
        </md-form-field>
      </div>

      <div class="demo-full-width">
        <md-form-field>
          <input mdInput [(ngModel)]="CurrentPlan.ValidFrom" [mdDatepicker]="vfmpicker" placeholder="{{'Home.ValidFrom' | translate}}">
          <md-datepicker-toggle mdSuffix [for]="vfmpicker"></md-datepicker-toggle>
          <md-datepicker #vfmpicker></md-datepicker>
        </md-form-field>
        <md-form-field>
          <input mdInput [(ngModel)]="CurrentPlan.ValidTo" [mdDatepicker]="vtopicker" placeholder="{{'Home.ValidTo' | translate}}">
          <md-datepicker-toggle mdSuffix [for]="vtopicker"></md-datepicker-toggle>
          <md-datepicker #vtopicker></md-datepicker>
        </md-form-field>
      </div>

      <md-select class="demo-full-width" placeholder="{{'Home.Type' | translate}}" [(ngModel)]="CurrentPlan.QuizType" name="planqtype">
        <md-option *ngFor="let qt of listQTypes" [value]="qt.value">
          {{ qt.displayas | translate }}
        </md-option>
      </md-select>

      <md-form-field class="demo-full-width">
        <input mdInput type="number" placeholder="{{'Home.Score' | translate}}" [(ngModel)]="CurrentPlan.MinQuizSocre">
      </md-form-field>

      <md-form-field class="demo-full-width">
        <input mdInput type="number" placeholder="{{'Home.AdjAvgTimeSpentEachInSeconds' | translate}}" [(ngModel)]="CurrentPlan.MinQuizAvgTime">
      </md-form-field>

      <md-form-field class="demo-full-width">
        <input mdInput type="number" placeholder="{{'Home.AwardPoint' | translate}}" [(ngModel)]="CurrentPlan.Award">
      </md-form-field>
    </div>
  </md-card-content>
  <md-card-actions>
    <button md-button *ngIf="!IsListView" (click)="onDetailPlanSubmit()" [disabled]="!CanDetailPlanSubmit()">{{'Home.SubmitButton' | translate }}</button>
    <button md-button *ngIf="!IsListView" (click)="onDetailPlanCancel()">{{'Home.CancelButton' | translate }}</button>
  </md-card-actions>
</md-card>
